FROM alpine

EXPOSE 8081

ENTRYPOINT ["/usr/sbin/happydns"]

ENV HAPPYDNS_LEVELDB_PATH=/data/happydns.db

RUN apk add --no-cache \
        curl \
        jq \
    && \
    adduser --system --no-create-home --uid 15353 happydns && \
    mkdir /data && chown happydns /data
USER happydns
WORKDIR /data

VOLUME /data

COPY happydns /usr/sbin/happydns
COPY hadmin.sh /usr/bin/hadmin
